import{_ as V}from"./index.vue_vue_type_script_setup_true_lang-Dob7ZLHY.js";import{aE as D,X as Q,Y as T,ag as E,Q as $,b0 as N,ae as O,a9 as H,H as j,S as z,aa as G,a8 as L,aW as W,an as X}from"./antd-D0j5ONzc.js";import{d as A,f as g,c as Y,a4 as I,ab as B,ac as a,k as e,u as n,H as J,s as K,G as v,a2 as Z,ag as ee}from"./vue-BG1emjmP.js";import{u as ae,g as ne,d as le}from"./table-query-CBn_79jg.js";import{u as te,_ as oe}from"./index-PN1Wd5oG.js";import"./context-Bc3isd9L.js";const ue=A({__name:"crud-table-modal",emits:["cancel","ok"],setup(F,{expose:y,emit:x}){const l=x,k=g(!1),m=g(!1),C=Y(()=>k.value?"编辑":"新增"),c=g(),d=g({name:"",value:""}),w={style:{width:"100px"}},q={span:24};function s(t){m.value=!0,k.value=!!(t!=null&&t.id),d.value=D(t)??{name:"",value:""}}async function r(){var t;try{await((t=c.value)==null?void 0:t.validate()),l("ok"),m.value=!1}catch(o){console.log("Form Validate Failed:",o)}}function f(){var t;(t=c.value)==null||t.resetFields(),l("cancel")}return y({open:s}),(t,o)=>{const i=Q,p=T,h=E,P=$,b=N;return I(),B(b,{open:n(m),"onUpdate:open":o[3]||(o[3]=_=>J(m)?m.value=_:null),title:n(C),onOk:r,onCancel:f},{default:a(()=>[e(P,{ref_key:"formRef",ref:c,model:n(d),class:"w-full","label-col":w,"wrapper-col":q},{default:a(()=>[e(p,{name:"name",label:"名",rules:[{required:!0,message:"请输入名"}]},{default:a(()=>[e(i,{value:n(d).name,"onUpdate:value":o[0]||(o[0]=_=>n(d).name=_),maxlength:50,placeholder:"请输入名"},null,8,["value"])]),_:1}),e(p,{name:"value",label:"值",rules:[{required:!0,message:"请输入值"}]},{default:a(()=>[e(i,{value:n(d).value,"onUpdate:value":o[1]||(o[1]=_=>n(d).value=_),maxlength:50,placeholder:"请输入值"},null,8,["value"])]),_:1}),e(p,{name:"remark",label:"备注"},{default:a(()=>[e(h,{value:n(d).remark,"onUpdate:value":o[2]||(o[2]=_=>n(d).remark=_),"show-count":"",maxlength:200,placeholder:"请输入备注"},null,8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])}}}),re={key:0,flex:"","gap-2":""},se=A({__name:"crud-table",setup(F){const y=te(),x=K([{title:"名",dataIndex:"name"},{title:"值",dataIndex:"value"},{title:"描述",dataIndex:"remark"},{title:"操作",dataIndex:"action"}]),{state:l,initQuery:k,resetQuery:m,query:C}=ae({queryApi:ne,queryParams:{name:void 0,value:void 0,remark:void 0},afterQuery:s=>(console.log(s),s)}),c=g();async function d(s){if(!s.id)return y.error("id 不能为空");try{(await le(s.id)).code===200&&await C(),y.success("删除成功")}catch(r){console.log(r)}finally{close()}}function w(){var s;(s=c.value)==null||s.open()}function q(s){var r;(r=c.value)==null||r.open(s)}return(s,r)=>{const f=Q,t=T,o=H,i=j,p=z,h=G,P=$,b=L,_=W,M=X,R=V;return I(),B(R,null,{default:a(()=>[e(b,{"mb-4":""},{default:a(()=>[e(P,{class:"system-crud-wrapper","label-col":{span:7},model:n(l).queryParams},{default:a(()=>[e(h,{gutter:[15,0]},{default:a(()=>[e(o,{span:6},{default:a(()=>[e(t,{name:"name",label:"名"},{default:a(()=>[e(f,{value:n(l).queryParams.name,"onUpdate:value":r[0]||(r[0]=u=>n(l).queryParams.name=u),placeholder:"请输入名"},null,8,["value"])]),_:1})]),_:1}),e(o,{span:6},{default:a(()=>[e(t,{name:"value",label:"值"},{default:a(()=>[e(f,{value:n(l).queryParams.value,"onUpdate:value":r[1]||(r[1]=u=>n(l).queryParams.value=u),placeholder:"请输入值"},null,8,["value"])]),_:1})]),_:1}),e(o,{span:6},{default:a(()=>[e(t,{name:"remark",label:"备注"},{default:a(()=>[e(f,{value:n(l).queryParams.remark,"onUpdate:value":r[2]||(r[2]=u=>n(l).queryParams.remark=u),placeholder:"请输入备注"},null,8,["value"])]),_:1})]),_:1}),e(o,{span:6},{default:a(()=>[e(p,{flex:"","justify-end":"","w-full":""},{default:a(()=>[e(i,{loading:n(l).loading,type:"primary",onClick:n(k)},{default:a(()=>[v(" 查询 ")]),_:1},8,["loading","onClick"]),e(i,{loading:n(l).loading,onClick:n(m)},{default:a(()=>[v(" 重置 ")]),_:1},8,["loading","onClick"])]),_:1})]),_:1})]),_:1})]),_:1},8,["model"])]),_:1}),e(b,{title:"增删改查表格"},{extra:a(()=>[e(p,{size:"middle"},{default:a(()=>[e(i,{type:"primary",onClick:w},{icon:a(()=>[e(n(O))]),default:a(()=>[v(" 新增 ")]),_:1})]),_:1})]),default:a(()=>[e(M,{"row-key":"id","row-selection":n(l).rowSelections,loading:n(l).loading,columns:n(x),"data-source":n(l).dataSource,pagination:n(l).pagination},{bodyCell:a(u=>{var U;return[((U=u==null?void 0:u.column)==null?void 0:U.dataIndex)==="action"?(I(),Z("div",re,[e(i,{type:"link",onClick:S=>q(u==null?void 0:u.record)},{default:a(()=>[v(" 编辑 ")]),_:2},1032,["onClick"]),e(_,{title:"确定删除该条数据？","ok-text":"确定","cancel-text":"取消",onConfirm:S=>d(u==null?void 0:u.record)},{default:a(()=>[e(i,{type:"link"},{default:a(()=>[v(" 删除 ")]),_:1})]),_:2},1032,["onConfirm"])])):ee("",!0)]}),_:1},8,["row-selection","loading","columns","data-source","pagination"])]),_:1}),e(ue,{ref_key:"crudTableModal",ref:c},null,512)]),_:1})}}}),fe=oe(se,[["__scopeId","data-v-7a0f44a0"]]);export{fe as default};

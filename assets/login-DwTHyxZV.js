var re=Object.defineProperty;var ie=(n,i,c)=>i in n?re(n,i,{enumerable:!0,configurable:!0,writable:!0,value:c}):n[i]=c;var w=(n,i,c)=>ie(n,typeof i!="symbol"?i+"":i,c);import{_ as U,f as le,u as ce,g as de,d as pe,h as ue,e as me,j as ge,A as he}from"./index-BGYLezH8.js";import{a4 as p,a2 as _,a7 as l,d as _e,V as fe,r as ve,s as L,f as Z,ao as we,o as xe,u as e,j as be,af as h,ab as E,k as s,ac as d,a8 as ye,ae as ke,ag as q,F as x,G as z,a5 as ze,a6 as $e}from"./vue-BG1emjmP.js";import{_ as Ce}from"./logo-Ft4BtHHg.js";import{_ as Me}from"./index.vue_vue_type_style_index_0_lang-F1R8y8oM.js";import{v as Le,F as Ee,U as qe,w as R,x as Ie,y as Se,t as Pe,T as Te,z as Ae,I as Re,B as Be,E as Ue,H as Ne}from"./antd-B7NuRx5N.js";var Ve=async(n=0)=>new Promise(i=>{const c=setTimeout(()=>{i(!0),clearTimeout(c)},n)});const Fe={name:"CarbonSun"},He={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 32 32"},Ke=l("path",{fill:"currentColor",d:"M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6ZM5.394 6.813L6.81 5.399l3.505 3.506L8.9 10.319zM2 15.005h5v2H2zm3.394 10.193L8.9 21.692l1.414 1.414l-3.505 3.506zM15 25.005h2v5h-2zm6.687-1.9l1.414-1.414l3.506 3.506l-1.414 1.414zm3.313-8.1h5v2h-5zm-3.313-6.101l3.506-3.506l1.414 1.414l-3.506 3.506zM15 2.005h2v5h-2z"},null,-1),Oe=[Ke];function Ze(n,i,c,f,g,I){return p(),_("svg",He,Oe)}const De=U(Fe,[["render",Ze]]),Ge={name:"CarbonMoon"},Qe={xmlns:"http://www.w3.org/2000/svg",width:"1em",height:"1em",viewBox:"0 0 32 32"},We=l("path",{fill:"currentColor",d:"M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3Z"},null,-1),je=[We];function Ye(n,i,c,f,g,I){return p(),_("svg",Qe,je)}const Je=U(Ge,[["render",Ye]]),Xe="/assets/bg4-DKEYr-Z2.png";function et(n,i=""){var g;const c=((g=le.currentRoute.value)==null?void 0:g.query)??{},f=Le(c,n)??i;return decodeURIComponent(f)}const t={width:0,height:0,canvas:null,ctx:null,circles:[],animate:!0,requestId:null},tt=function(n){if(!t||!n)throw new Error("no canvasInstance");t.width=window.innerWidth,t.height=window.innerHeight,t.canvas=n,t.canvas.width=t.width,t.canvas.height=t.height,t.ctx=t.canvas.getContext("2d"),t.circles=[];for(let i=0;i<t.width*.5;i++){const c=new at;t.circles.push(c)}W(),ot()};function G(){t.animate=!(document.body.scrollTop>t.height)}function Q(){t.width=window.innerWidth,t.height=window.innerHeight,t.canvas.width=t.width,t.canvas.height=t.height}function W(){if(t.animate){t.ctx.clearRect(0,0,t.width,t.height);for(const n in t.circles)t.circles[n].draw()}t.requestId=requestAnimationFrame(W)}class at{constructor(){w(this,"pos");w(this,"alpha");w(this,"scale");w(this,"velocity");w(this,"draw");this.pos={x:Math.random()*t.width,y:t.height+Math.random()*100},this.alpha=.1+Math.random()*.3,this.scale=.1+Math.random()*.3,this.velocity=Math.random();const i=Math.random()*255,c=Math.random()*255,f=Math.random()*255;this.draw=function(){this.pos.y-=this.velocity,this.alpha-=5e-4,t.ctx.beginPath(),t.ctx.arc(this.pos.x,this.pos.y,this.scale*10,0,2*Math.PI,!1),t.ctx.fillStyle=`rgba(${i},${c},${f},${this.alpha})`,t.ctx.fill()}}}function ot(){window.addEventListener("scroll",G),window.addEventListener("resize",Q)}function st(){window.removeEventListener("scroll",G),window.removeEventListener("resize",Q),cancelAnimationFrame(t.requestId)}const D={init:tt,removeListeners:st},j=n=>(ze("data-v-f58adca8"),n=n(),$e(),n),nt={class:"login-container"},rt={"h-screen":"","w-screen":"",absolute:"","z-10":""},it={class:"login-content flex-center"},lt={class:"ant-pro-form-login-main rounded"},ct={class:"flex-between h-15 px-4 mb-[2px]"},dt={class:"flex-end"},pt=j(()=>l("span",{class:"ant-pro-form-login-logo"},[l("img",{"w-full":"","h-full":"","object-cover":"",src:Ce})],-1)),ut=j(()=>l("span",{class:"ant-pro-form-login-title"}," 车联网管理系统 ",-1)),mt={class:"ant-pro-form-login-desc"},gt={class:"login-lang flex-center relative z-11"},ht={class:"box-border flex min-h-[520px]"},_t=ye('<div class="ant-pro-form-login-main-left min-h-[520px] flex-center bg-[var(--bg-color-container)]" data-v-f58adca8><img src="'+Xe+'" class="h-20/24 w-88/100" data-v-f58adca8><div class="aver2 min-h-[520px] max-w-[190px] flex-center" data-v-f58adca8><a id="li9" class="w-1/1 flex-center" data-v-f58adca8><img class="w-3/4" src="http://www.18gps.net/Skins/paobudiu/app/mobiledownload/images/QRcode.png" data-v-f58adca8><h2 class="qRcodeTitle c-text" data-v-f58adca8>云车管家</h2><p class="c-textSecondary" style="font-size:12px;" data-v-f58adca8>一款操作简单方便的基础版APP，具备实时查车、回放轨迹、下发指令、实时接收设备故障与异常报警推送等基础功能。</p></a></div></div>',1),ft={class:"ant-pro-form-login-main-right px-5 w-[335px] flex-center flex-col relative z-11"},vt={class:"text-center py-6 text-2xl"},wt={flex:"","items-center":""},xt={flex:"","items-center":""},bt=["data-theme"],B=60,yt=_e({__name:"login",setup(n){const i=ce(),c=de(),f=pe(),{layoutSetting:g}=fe(f),I=ke(),Y=ue(),a=ve({username:void 0,password:void 0,mobile:void 0,code:void 0,type:"account",remember:!0}),{t:r}=me(),$=L(),b=L(!1),S=L(!1),P=L(!1),N=Z(),{counter:V,pause:J,reset:X,resume:ee,isActive:C}=we(1e3,{controls:!0,immediate:!1,callback(m){m&&m===B&&J()}}),F=Z(!1),te=[{type:"number",asyncValidator:()=>new Promise((m,o)=>{!a.username||!a.password?o(new Error("获取验证码前需先输入账号密码！")):a.code?m(!0):F.value?o(new Error(r("pages.login.captcha.required"))):o(new Error("请获取验证码！"))})}];async function H(){try{!a.username||!a.password?await $.value.validate(["code"]):(console.log("校验通过"),$.value.validate(["code"]),b.value=!0,setTimeout(()=>{X(),ee(),b.value=!1,F.value=!0,i.success("验证码是：123456")},3e3))}catch(m){console.log(m),b.value=!1}}async function v(){var m;S.value=!0;try{await((m=$.value)==null?void 0:m.validate());let o;a.type==="account"?o={username:a.username,password:a.password,code:a.code}:o={mobile:a.mobile,code:a.code,type:"mobile"},console.log("2");{const{data:y}=await ge(o);Y.value=y==null?void 0:y.token}c.success({message:"登录成功",description:"欢迎回来！",duration:3});const T=et("redirect","/");I.push({path:T,replace:!0})}catch(o){o instanceof he&&(P.value=!0),S.value=!1}}return xe(async()=>{await Ve(300),D.init(e(N))}),be(()=>{D.removeListeners()}),(m,o)=>{const T=Je,y=De,K=Se,ae=Pe,oe=Te,O=Ae,M=Re,k=Be,se=Ue,A=Ne,ne=Ee;return p(),_("div",nt,[l("div",rt,[l("canvas",{ref_key:"bubbleCanvas",ref:N},null,512)]),l("div",it,[l("div",lt,[l("div",ct,[l("div",dt,[pt,ut,l("span",mt,h(e(r)("pages.layouts.userLayout.title")),1)]),l("div",gt,[l("span",{class:"flex-center cursor-pointer text-16px",onClick:o[0]||(o[0]=u=>e(f).toggleTheme(e(g).theme==="dark"?"light":"dark"))},[e(g).theme==="light"?(p(),E(T,{key:0})):(p(),E(y,{key:1}))])])]),s(K,{"m-0":""}),l("div",ht,[_t,s(K,{"m-0":"",type:"vertical",class:"ant-pro-login-divider min-h-[520px]"}),l("div",ft,[l("div",vt,h(e(r)("pages.login.tips")),1),s(ne,{ref_key:"formRef",ref:$,model:e(a)},{default:d(()=>[s(oe,{activeKey:e(a).type,"onUpdate:activeKey":o[1]||(o[1]=u=>e(a).type=u),centered:""},{default:d(()=>[s(ae,{key:"account",tab:e(r)("pages.login.accountLogin.tab")},null,8,["tab"])]),_:1},8,["activeKey"]),e(P)&&e(a).type==="account"?(p(),E(O,{key:0,"mb-24px":"",message:e(r)("pages.login.accountLogin.errorMessage"),type:"error","show-icon":""},null,8,["message"])):q("",!0),e(P)&&e(a).type==="mobile"?(p(),E(O,{key:1,"mb-24px":"",message:e(r)("pages.login.phoneLogin.errorMessage"),type:"error","show-icon":""},null,8,["message"])):q("",!0),e(a).type==="account"?(p(),_(x,{key:2},[s(k,{name:"username",rules:[{required:!0,message:e(r)("pages.login.username.required")}]},{default:d(()=>[s(M,{value:e(a).username,"onUpdate:value":o[2]||(o[2]=u=>e(a).username=u),"allow-clear":"",autocomplete:"off",placeholder:e(r)("pages.login.username.placeholder"),size:"large",onPressEnter:v},{prefix:d(()=>[s(e(qe))]),_:1},8,["value","placeholder"])]),_:1},8,["rules"]),s(k,{name:"password",rules:[{required:!0,message:e(r)("pages.login.password.required")}]},{default:d(()=>[s(se,{value:e(a).password,"onUpdate:value":o[3]||(o[3]=u=>e(a).password=u),"allow-clear":"",placeholder:e(r)("pages.login.password.placeholder"),size:"large",onPressEnter:v},{prefix:d(()=>[s(e(R))]),_:1},8,["value","placeholder"])]),_:1},8,["rules"]),s(k,{name:"code",rules:te},{default:d(()=>[l("div",wt,[s(M,{value:e(a).code,"onUpdate:value":o[4]||(o[4]=u=>e(a).code=u),style:{flex:"1 1 0%",transition:"width 0.3s ease 0s","margin-right":"8px"},"allow-clear":"",placeholder:e(r)("pages.login.captcha.placeholder"),size:"large",onPressEnter:v},{prefix:d(()=>[s(e(R))]),_:1},8,["value","placeholder"]),s(A,{loading:e(b),disabled:e(C),size:"large",onClick:H},{default:d(()=>[e(C)?(p(),_(x,{key:1},[z(h(B-e(V))+" "+h(e(r)("pages.getCaptchaSecondText")),1)],64)):(p(),_(x,{key:0},[z(h(e(r)("pages.login.phoneLogin.getVerificationCode")),1)],64))]),_:1},8,["loading","disabled"])])]),_:1})],64)):q("",!0),e(a).type==="mobile"?(p(),_(x,{key:3},[s(k,{name:"mobile",rules:[{required:!0,message:e(r)("pages.login.phoneNumber.required")},{pattern:/^(86)?1([38][0-9]|4[579]|5[0-35-9]|6[6]|7[0135678]|9[89])[0-9]{8}$/,message:e(r)("pages.login.phoneNumber.invalid")}]},{default:d(()=>[s(M,{value:e(a).mobile,"onUpdate:value":o[5]||(o[5]=u=>e(a).mobile=u),"allow-clear":"",placeholder:e(r)("pages.login.phoneNumber.placeholder"),size:"large",onPressEnter:v},{prefix:d(()=>[s(e(Ie))]),_:1},8,["value","placeholder"])]),_:1},8,["rules"]),s(k,{name:"code",rules:[{required:!0,message:e(r)("pages.login.captcha.required")}]},{default:d(()=>[l("div",xt,[s(M,{value:e(a).code,"onUpdate:value":o[6]||(o[6]=u=>e(a).code=u),style:{flex:"1 1 0%",transition:"width 0.3s ease 0s","margin-right":"8px"},"allow-clear":"",placeholder:e(r)("pages.login.captcha.placeholder"),size:"large",onPressEnter:v},{prefix:d(()=>[s(e(R))]),_:1},8,["value","placeholder"]),s(A,{loading:e(b),disabled:e(C),size:"large",onClick:H},{default:d(()=>[e(C)?(p(),_(x,{key:1},[z(h(B-e(V))+" "+h(e(r)("pages.getCaptchaSecondText")),1)],64)):(p(),_(x,{key:0},[z(h(e(r)("pages.login.phoneLogin.getVerificationCode")),1)],64))]),_:1},8,["loading","disabled"])])]),_:1},8,["rules"])],64)):q("",!0),s(A,{type:"primary","mt-4":"",block:"",loading:e(S),size:"large",onClick:v},{default:d(()=>[z(h(e(r)("pages.login.submit")),1)]),_:1},8,["loading"])]),_:1},8,["model"])])])])]),l("div",{"py-24px":"","px-50px":"",fixed:"","bottom-0":"","z-11":"","w-screen":"","data-theme":e(g).theme,"text-14px":""},[s(Me,{copyright:e(g).copyright,icp:"鲁ICP备2024071414号-1"},null,8,["copyright"])],8,bt)])}}}),Et=U(yt,[["__scopeId","data-v-f58adca8"]]);export{Et as default};

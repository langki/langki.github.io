import{a1 as M,f as _,s as N,d as S,ap as k,l as y,az as T,k as A,V as L,aa as b,a4 as d,ab as P,ac as x,q as V,u as v,aA as E,ak as R}from"./vue-BG1emjmP.js";import{d as I,u as B,f as w,i as K}from"./index-BGYLezH8.js";const O=["/login","/404","/403"],W=M("multi-tab",()=>{const n=_([]),u=N(),l=_(null),o=I(),a=_([]),f=B(),r=e=>{if(!e||e.path.startsWith("/redirect")||e.path.startsWith("/common")||e.path==="/"||O.includes(e.path))return;if(l.value&&setTimeout(()=>{l.value&&(l.value.loading=!1,l.value=null)},500),n.value.some(m=>m.fullPath===e.fullPath)){!a.value.includes(e==null?void 0:e.name)&&o.layoutSetting.keepAlive&&e.meta.keepAlive&&e.name&&a.value.push(e.name);return}const t={path:e.path,fullPath:e.fullPath,title:e.meta.title,name:e.name,icon:e.meta.icon,affix:e.meta.affix,locale:e.meta.locale};!a.value.includes(t==null?void 0:t.name)&&o.layoutSetting.keepAlive&&e.meta.keepAlive&&e.name&&a.value.push(e.name),n.value.push(t)},c=e=>{if(n.value.length<=1){f.error("不能关闭最后一个标签页");return}const t=n.value.findIndex(s=>s.fullPath===e);if(t<0){f.error("当前页签不存在无法关闭");return}const m=n.value[t];if(m.fullPath===u.value){const s=t===0?n.value[t+1]:n.value[t-1];u.value=s.fullPath,w.push(s.fullPath)}o.layoutSetting.keepAlive&&m.name&&(a.value=a.value.filter(s=>s!==m.name)),n.value=n.value.filter(s=>s.fullPath!==e)},h=e=>{const t=n.value.find(m=>m.fullPath===e);t&&(a.value=a.value.filter(m=>m!==t.name),t.loading=!0,l.value=t,w.replace(`/redirect/${encodeURIComponent(t.fullPath)}`))},i=e=>{e!==u.value&&w.push(e)};return{list:n,activeKey:u,cacheList:a,close:c,clear:()=>{n.value=[],a.value=[],u.value=void 0,l.value=null},closeLeft:e=>{i(e);const t=n.value.findIndex(s=>s.fullPath===e);n.value.slice(0,t).forEach(s=>{s.affix||c(s.fullPath)})},closeRight:e=>{i(e);const t=n.value.findIndex(s=>s.fullPath===e);n.value.slice(t+1).forEach(s=>{s.affix||c(s.fullPath)})},closeOther:e=>{i(e),n.value.forEach(t=>{t.affix||t.fullPath!==e&&c(t.fullPath)})},refresh:h,switchTab:i,addItem:r}}),q=S({name:"ParentCompConsumer",setup(n,{slots:u}){const l=k(),o=new Map;return()=>{var r,c,h;const a=(r=l.meta)==null?void 0:r.parentName,f=(c=l.meta)==null?void 0:c.parentComps;if(a){if(o.has(a))return o.get(a);if(f!=null&&f.length){let i;for(const p of[...f].reverse()){const C=K(p)?T(p):p;i?i=y(C,null,{default:()=>i}):i=y(C,null,u)}if(i)return o.set(a,i),i}}return(h=u==null?void 0:u.default)==null?void 0:h.call(u)}}}),g=new Map;function z(){const n=k();return{getComp:l=>{var c;if(!n.name)return l;const o=(c=l==null?void 0:l.type)==null?void 0:c.name,a=n.name;if(g.has(a))return g.get(a);const f=l;if(o&&o===a)return g.set(a,f),f;const r=A(f);return r.type||(r.type={}),r.type.name=a,g.set(a,r),r}}}const j=S({name:"CustomRouteView",__name:"route-view",setup(n){const u=I(),{layoutSetting:l}=L(u),o=W(),{cacheList:a}=L(o),{getComp:f}=z();return(r,c)=>{const h=b("RouterView");return d(),P(v(q),null,{default:x(()=>[A(h,null,{default:x(({Component:i,route:p})=>[A(V,{appear:"",name:v(l).animationName,mode:"out-in"},{default:x(()=>[v(l).keepAlive?(d(),P(E,{key:0,include:[...v(a)]},[(d(),P(R(v(f)(i)),{key:p.fullPath}))],1032,["include"])):(d(),P(R(i),{key:p.fullPath}))]),_:2},1032,["name"])]),_:1})]),_:1})}}});export{j as _,W as u};
